<!DOCTYPE html>
<html>
<head>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@clappr/player@latest/dist/clappr.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/swarmcloud-hls@latest/dist/p2p-engine.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/swarmcloud-hls@latest/dist/clappr-p2p-plugin.min.js"></script>
    <style>
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; }
        #player { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }
    </style>
</head>
<body>
    <div id="player"></div>
    <script>
        function obtenerURLm3u8() {
            // URL a la que deseas hacer la solicitud (reemplaza con tu URL m3u8)
            const url = 'https://sv1.streamtp.live/global1.php?stream=tyc_sports';
            const proxyUrl = 'https://cors-anywhere.herokuapp.com/' + url;
            
            return fetch(proxyUrl)
                .then(response => response.text())
                .catch(error => {
                    console.error('Error al obtener la URL m3u8:', error);
                    return null;
                });
        }

        function inicializarReproductor() {
            obtenerURLm3u8().then(playbackURL => {
                if (playbackURL) {
                    var p2pConfig = {
                        trackerZone: 'us',
                        sourceUrl: playbackURL
                    };

                    var player = new Clappr.Player({
                        source: playbackURL,
                        parentId: "#player",
                        poster: '',
                        width: '100%',
                        height: '100%',
                        autoPlay: false,
                        plugins: [SwarmCloudClapprPlugin],
                        playback: {
                            hlsjsConfig: {
                                maxBufferSize: 0,
                                maxBufferLength: 12,
                                liveSyncDurationCount: 3,
                                p2pConfig: p2pConfig
                            },
                            dvrEnabled: false,
                            dvrInUse: false
                        }
                    });
                } else {
                    console.error('No se pudo obtener la URL m3u8.');
                }
            });
        }

        inicializarReproductor();
    </script>
</body>
</html>
