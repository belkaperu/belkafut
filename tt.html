<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reproductor de Canales TV</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jwplayer/8.22.0/jwplayer.js"></script>
    <script>jwplayer.key = "XSuP4qMl+9tK17QNb+4+th2Pm9AWgMO/cYH8CI0HGGr7bdjo"</script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: #0f0f1e;
            color: #fff;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            overflow: hidden;
        }
        
        .container {
            display: flex;
            flex-direction: column;
            height: 100vh;
        }
        
        .top-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 20px;
            background: #1a1a2e;
            border-bottom: 1px solid #2d2d4d;
        }
        
        .logo {
            font-size: 1.5rem;
            font-weight: bold;
            color: #4cc9f0;
        }
        
        .channel-info {
            font-size: 1rem;
            color: #a0a0c0;
        }
        
        .player-container {
            flex: 1;
            background: #000;
            position: relative;
        }
        
        #player {
            width: 100%;
            height: 100%;
        }
        
        .player-placeholder {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background: #0a0a1a;
            z-index: 5;
        }
        
        .player-placeholder h3 {
            font-size: 1.5rem;
            margin-bottom: 10px;
            color: #4cc9f0;
        }
        
        .player-placeholder p {
            color: #a0a0c0;
            text-align: center;
        }
        
        .channel-list {
            display: flex;
            overflow-x: auto;
            padding: 15px;
            background: #131325;
            gap: 10px;
        }
        
        .channel-item {
            min-width: 100px;
            background: #1e1e3a;
            border-radius: 8px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }
        
        .channel-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
        }
        
        .channel-item.active {
            border: 2px solid #4cc9f0;
        }
        
        .channel-item img {
            width: 100%;
            height: 60px;
            object-fit: cover;
            background: #2a2a4a;
        }
        
        .channel-item p {
            padding: 8px 5px;
            font-size: 0.8rem;
        }
        
        @media (max-width: 768px) {
            .channel-item {
                min-width: 80px;
            }
            
            .channel-item p {
                font-size: 0.7rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="top-bar">
            <div class="logo">TVStream</div>
            <div class="channel-info" id="channel-info">Selecciona un canal</div>
        </div>
        
        <div class="player-container">
            <div id="player"></div>
            <div class="player-placeholder" id="player-placeholder">
                <h3>Cargando canal...</h3>
                <p>Por favor espera mientras se carga el contenido</p>
            </div>
        </div>
        
        <div class="channel-list" id="channel-list">
            <!-- Los canales se cargarán con JavaScript -->
        </div>
    </div>

    <script>
        // Objeto de canales
        const canales = {
            "mtvlive": {
                file: "//live1-ott.izzigo.tv/14/out/u/dash/MTV-LIVE-HD/default.mpd",
                keyId: "acc4581a25ef0cd76f8fd7d826bb2d06",
                key: "bc006e72e9aab57aca8ae75a83e8f20e",
                title: "MTV Live",
                logo: "https://logodownload.org/wp-content/uploads/2013/11/mtv-music-television-logo-1-1.png"
            },
            "espn1": {
                file: "//live1-ott.izzigo.tv/11/out/u/dash/ESPN-HD/default.mpd",
                keyId: "bb43112b7b72e9c287da0ecdec8606a7",
                key: "29e3d2678107f0ab0b35b6537c734f2a",
                title: "ESPN",
                logo: "https://upload.wikimedia.org/wikipedia/commons/thumb/2/2f/ESPN_wordmark.svg/800px-ESPN_wordmark.svg.png"
            },
            "espn2": {
                file: "//live1-ott.izzigo.tv/11/out/u/dash/ESPN-2-HD/default.mpd",
                keyId: "90e2e491c850a49a5ab21bb6fa6b4d24",
                key: "4d7e33da19b971cef49e35eccdb9de0b",
                title: "ESPN 2",
                logo: "https://upload.wikimedia.org/wikipedia/commons/thumb/2/2f/ESPN_wordmark.svg/800px-ESPN_wordmark.svg.png"
            },
            "goldenedge": {
                file: "//live1-ott.izzigo.tv/13/out/u/dash/GOLDEN-EDGE-SD/default.mpd",
                keyId: "98aa90cb620b972a0d0d66a51cdaca56",
                key: "6e8bd53378356ed7f5103d91efb5e54e",
                title: "Golden Edge",
                logo: "https://via.placeholder.com/120x70/2a2a4a/ffffff?text=Golden+Edge"
            },
            // ... (agrega aquí el resto de canales de tu lista)
        };

        // Inicializar el reproductor
        var playerInstance = jwplayer("player");
        
        // Obtener canal de la URL
        const params = new URLSearchParams(window.location.search);
        const canal = params.get("channel");
        
        // Elementos DOM
        const channelList = document.getElementById("channel-list");
        const playerPlaceholder = document.getElementById("player-placeholder");
        const channelInfo = document.getElementById("channel-info");
        
        // Cargar lista de canales
        function loadChannelList() {
            // Limpiar lista
            channelList.innerHTML = '';
            
            // Agregar canales a la lista
            for (const [id, canal] of Object.entries(canales)) {
                const item = document.createElement("div");
                item.className = "channel-item";
                item.dataset.channel = id;
                
                const img = document.createElement("img");
                img.src = canal.logo || "https://via.placeholder.com/100x60/2a2a4a/ffffff?text=TV";
                img.alt = canal.title;
                
                const title = document.createElement("p");
                title.textContent = canal.title;
                
                item.appendChild(img);
                item.appendChild(title);
                
                item.addEventListener("click", () => {
                    loadChannel(id);
                });
                
                channelList.appendChild(item);
            }
        }
        
        // Cargar un canal específico
        function loadChannel(channelId) {
            if (canales[channelId]) {
                const c = canales[channelId];
                
                // Mostrar placeholder
                playerPlaceholder.style.display = "flex";
                playerPlaceholder.innerHTML = "<h3>Cargando " + c.title + "...</h3><p>Por favor espera mientras se carga el contenido</p>";
                
                // Actualizar URL
                window.history.replaceState({}, '', `?channel=${channelId}`);
                
                // Actualizar información del canal
                channelInfo.textContent = c.title;
                
                // Resaltar canal seleccionado
                document.querySelectorAll('.channel-item').forEach(item => {
                    item.classList.remove('active');
                });
                
                document.querySelector(`[data-channel="${channelId}"]`).classList.add('active');
                
                // Configurar el reproductor con DRM ClearKey
                playerInstance.setup({
                    playlist: [{
                        title: c.title,
                        image: "",
                        sources: [{
                            default: false,
                            type: "dash",
                            file: c.file,
                            drm: {
                                clearkey: {
                                    keyId: c.keyId,
                                    key: c.key
                                }
                            }
                        }]
                    }],
                    width: "100%",
                    height: "100%",
                    aspectratio: "16:9",
                    autostart: true
                });
                
                // Ocultar placeholder cuando el reproductor esté listo
                playerInstance.on('ready', function() {
                    playerPlaceholder.style.display = "none";
                });
                
                // Manejar errores
                playerInstance.on('error', function(e) {
                    console.error('Error del reproductor:', e);
                    playerPlaceholder.style.display = "flex";
                    playerPlaceholder.innerHTML = "<h3>Error al cargar el canal</h3><p>Intenta seleccionar otro canal</p>";
                });
            } else {
                // Mostrar error si el canal no existe
                playerPlaceholder.style.display = "flex";
                playerPlaceholder.innerHTML = "<h3>Canal no encontrado</h3><p>El canal solicitado no está disponible</p>";
                channelInfo.textContent = "Canal no encontrado";
            }
        }
        
        // Inicializar
        document.addEventListener("DOMContentLoaded", () => {
            loadChannelList();
            
            // Cargar canal desde URL o mostrar mensaje
            if (canal && canales[canal]) {
                loadChannel(canal);
            } else {
                playerPlaceholder.innerHTML = "<h3>Selecciona un canal</h3><p>Usa la lista inferior para elegir un canal</p>";
                channelInfo.textContent = "Selecciona un canal";
            }
        });
    </script>
</body>
</html>
